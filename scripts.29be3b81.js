parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({44:[function(require,module,exports) {
"use strict";function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";throw new Error("Not Implemented"+(e?": "+e:""))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TODO=e;
},{}],20:[function(require,module,exports) {
"use strict";var t=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./utils"),i=function(){function i(t,n,o,r,u,s,c){e(this,i),this.parent=t,this.name=n,this.position=o,this.args=r,this.methodBody=u,this.stack=s,this.locals=c}return t(i,[{key:"getInstruction",value:function(t){var e=this.methodBody.code.find(function(e){return e.position===t});if(!e)throw new Error("No instruction found with position "+t);return e}},{key:"next",value:function(t){if(t)this.getInstruction(t),this.position=t;else{var e=this.methodBody.code.indexOf(this.currentInstruction);this.position=this.methodBody.code[e+1].position}}},{key:"return",value:function(t){n.TODO("Frame#return")}},{key:"callStaticMethod",value:function(t){n.TODO("Frame#callStaticMethod")}},{key:"callObjectMethod",value:function(t){n.TODO("Frame#callObjectMethod")}},{key:"currentInstruction",get:function(){return this.getInstruction(this.position)}}]),i}();exports.Frame=i;
},{"./utils":44}],21:[function(require,module,exports) {
"use strict";var t=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(t){e(this,n),this._list=[],this._list=Array.apply(null,Array(t))}return t(n,[{key:"get",value:function(t){return this._list[t]}},{key:"set",value:function(t,e){this._list[t]=e}},{key:"list",get:function(){return this._list}}]),n}();exports.LocalVariables=n;
},{}],22:[function(require,module,exports) {
"use strict";var t=function(){function t(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,n,e){return n&&t(i.prototype,n),e&&t(i,e),i}}();function i(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(t){i(this,n),this._position=0,this._list=Array.apply(null,Array(t))}return t(n,[{key:"push",value:function(t){this._list[this._position]=t,this._position++}},{key:"pop",value:function(){var t=this._list[this._position];return this._position--,t}},{key:"peek",value:function(){return this._list[this._position]}},{key:"list",get:function(){return this._list}}]),n}();exports.OperandStack=n;
},{}],11:[function(require,module,exports) {
"use strict";var e=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}();function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./Frame"),t=require("./LocalVariables"),o=require("./OperandStack"),a=function(){function a(e,i){r(this,a),this.constantPool=e,this.methods=i,this.frames=[];var s=i.get("main");if(!s)throw new Error("'main' method is missing");var c=new n.Frame(this,"main",s.code[0].position,[],s,new o.OperandStack(s.stack),new t.LocalVariables(s.locals));this.frames.push(c)}return e(a,[{key:"next",value:function(){var e=this.frames[this.frames.length-1],r=(e.methodBody,e.position,e.currentInstruction);console.log("Eval "+r.instruction.code),r.instruction.apply(e),console.log({currentFrame:e})}}]),a}();exports.Frames=a;
},{"./Frame":20,"./LocalVariables":21,"./OperandStack":22}],26:[function(require,module,exports) {
"use strict";var r=function(){return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,t){var e=[],n=!0,o=!1,a=void 0;try{for(var i,u=r[Symbol.iterator]();!(n=(i=u.next()).done)&&(e.push(i.value),!t||e.length!==t);n=!0);}catch(r){o=!0,a=r}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return e}(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(exports,"__esModule",{value:!0});var t=function(t){var e=/^\s*#(\d+) = ([a-zA-Z0-8]*)\s+(\S*)(\s+\/\/\s(.*))?$/gm.exec(t),n=Array.from(e||[]),o=r(n,6),a=(o[0],o[1]),i=o[2],u=o[3],s=(o[4],o[5]);return{index:parseInt(a,10),type:i,value:s||u}};exports.constantPoolParser={parse:function(r){return r.split("\n").map(function(r){return r.trim()}).filter(function(r){return""!==r}).map(function(r){return t(r)})}};
},{}],65:[function(require,module,exports) {
"use strict";var e;function t(t){switch(t){case e.Int:return"i";case e.Long:return"l";case e.Float:return"f";case e.Double:return"d";case e.Char:return"c";case e.Short:return"s";default:throw new Error("Unexpected type "+t)}}Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e[e.Constant=0]="Constant",e[e.Int=1]="Int",e[e.Long=2]="Long",e[e.Float=3]="Float",e[e.Double=4]="Double",e[e.Char=5]="Char",e[e.Short=6]="Short"}(e=exports.Type||(exports.Type={})),exports.typePrefix=t;
},{}],50:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../input");exports.flowInstructions={};var n={ge:function(t,n){return t>=n},gt:function(t,n){return t>n},le:function(t,n){return t<=n},lt:function(t,n){return t<n},ne:function(t,n){return t!==n}},r=function(r,e){return{type:t.Type.Int,code:"if_icmp"+e,apply:function(t){var o=t.stack.pop().value,u=t.stack.pop().value,c=n[e](u,o);t.next(c?r:void 0)}}},e=function(t){return{code:"goto",apply:function(n){n.next(t)}}};exports.flowInstructions.if_icmpgt=function(t){var n=parseInt(t[0],10);return r(n,"gt")},exports.flowInstructions.goto=function(t){var n=parseInt(t[0],10);return e(n)},exports.flowInstructions.ireturn=function(){return{code:"ireturn",apply:function(t){var n=t.stack.pop();t.return(n)}}},exports.flowInstructions.return=function(){return{code:"return",apply:function(t){return t.return()}}};
},{"../input":65}],51:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../input");exports.mathInstructions={};var n=function(n,e,r){return{type:n,code:t.typePrefix(n)+e,apply:function(t){var e=t.stack.pop(),u=t.stack.pop();t.stack.push({type:n,value:r(e.value,u.value)}),t.next()}}},e=function(n,e,r){return{type:n,code:t.typePrefix(n)+e,apply:function(t){var e=t.stack.pop();t.stack.pop();t.stack.push({type:n,value:r(e.value)}),t.next()}}},r=function(n,e){return{type:t.Type.Int,code:"iinc",apply:function(t){var r=t.locals.get(n),u=r.type,o=r.value;t.locals.set(n,{type:u,value:o+e}),t.next()}}};[t.Type.Int,t.Type.Long,t.Type.Float,t.Type.Double].forEach(function(u){var o=t.typePrefix(u);exports.mathInstructions[o+"add"]=function(){return n(u,"add",function(t,n){return t+n})},exports.mathInstructions[o+"sub"]=function(){return n(u,"sub",function(t,n){return t-n})},exports.mathInstructions[o+"mul"]=function(){return n(u,"mul",function(t,n){return t*n})},exports.mathInstructions[o+"div"]=function(){return n(u,"rem",function(t,n){return t%n})},exports.mathInstructions[o+"neg"]=function(){return e(u,"neg",function(t){return-t})},exports.mathInstructions.iinc=function(t){var n=parseInt(t[0],10),e=parseInt(t[1],10);return r(n,e)}});
},{"../input":65}],52:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../input");exports.objectsInstructions={},exports.objectsInstructions.getstatic=function(e){return{code:"getstatic",apply:function(n){var o=e[0];n.stack.push({type:t.Type.Constant,value:o}),n.next()}}},exports.objectsInstructions.invokestatic=function(t){return{code:"invokestatic",apply:function(e){var n=t[0];e.callStaticMethod(n)}}},exports.objectsInstructions.invokevirtual=function(t){return{code:"invokevirtual",apply:function(e){var n=t[0];e.callObjectMethod(n)}}};
},{"../input":65}],53:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.otherInstructions={};
},{}],54:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../input");exports.stackInstructions={};var e=function(e,n){return{type:e,code:t.typePrefix(e)+"const_"+n,apply:function(t){t.stack.push({type:e,value:n}),t.next()}}},n=function(e,n){return{type:e,code:t.typePrefix(e)+"store_"+n,apply:function(t){var e=t.stack.pop();t.locals.set(n,e),t.next()}}},o=function(e,n){return{type:e,code:t.typePrefix(e)+"load_"+n,apply:function(t){var o=t.locals.get(n);t.stack.push({type:e,value:o}),t.next()}}};[t.Type.Int,t.Type.Long,t.Type.Float,t.Type.Double].forEach(function(r){for(var c=t.typePrefix(r),s=function(t){exports.stackInstructions[c+"const_"+t]=function(){return e(r,t)}},u=0;u<6;u++)s(u);var p=function(t){exports.stackInstructions[c+"store_"+t]=function(){return n(r,t)},exports.stackInstructions[c+"load_"+t]=function(){return o(r,t)}};for(u=0;u<4;u++)p(u)}),exports.stackInstructions.ldc=function(e){return{code:"ldc",apply:function(n){var o=e[0];n.stack.push({type:t.Type.Constant,value:o}),n.next()}}};
},{"../input":65}],47:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./flow"),e=require("./math"),r=require("./objects"),o=require("./others"),s=require("./stacks"),n=Object.assign({},s.stackInstructions,r.objectsInstructions,e.mathInstructions,t.flowInstructions,o.otherInstructions);console.log("Got "+Object.keys(n).length+" instructions"),exports.lookupInstruction=function(t,e){var r=n[t];if(r)return r(e);throw new Error("Opscode "+t+" not found !")};
},{"./flow":50,"./math":51,"./objects":52,"./others":53,"./stacks":54}],27:[function(require,module,exports) {
"use strict";var r=function(){return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,t){var n=[],e=!0,i=!1,o=void 0;try{for(var u,a=r[Symbol.iterator]();!(e=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);e=!0);}catch(r){i=!0,o=r}finally{try{!e&&a.return&&a.return()}finally{if(i)throw o}}return n}(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t=function(){function r(r,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}}();function n(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../models/instructions"),i=require("../../models/utils"),o=function(){function r(t,e,i,o){n(this,r),this.stack=t,this.locals=e,this.args_size=i,this.code=o}return t(r,[{key:"eval",value:function(){return i.TODO()}}]),r}(),u=function(t){var n=/^\s*(\d+): ([a-z0-9_]*)\s+(\S*)\s+\/\/\s(.*)$/gm.exec(t);if(null!==n){var i=Array.from(n||[]),o=r(i,5),u=(o[0],o[1]),a=o[2],s=o[3],c=o[4],l=parseInt(u,10),f=s&&c?[c]:s?[s]:[];return{position:l,instruction:e.lookupInstruction(a,f),args:f}}var p=/^\s*(\d+): ([a-z0-9_]*)(\s+([\d, ]*))?$/gm.exec(t);if(null!==p){var v=Array.from(p||[]),y=r(v,5),m=(y[0],y[1]),d=y[2],h=(y[3],y[4]),b=parseInt(m,10),w=h?h.split(", "):[];return{position:b,instruction:e.lookupInstruction(d,w),args:w}}throw new Error("Cannot parse line "+t)};exports.methodParser={parse:function(r,t,n,e,i){var a=i.split("\n").map(function(r){return r.trim()}).filter(function(r){return""!==r}).map(function(r){return u(r)});return new o(t,n,e,a)}};
},{"../../models/instructions":47,"../../models/utils":44}],12:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./impl/constant-parser"),a=require("./impl/instruction-parser"),n='#1 = Methodref          #6.#18         // java/lang/Object."<init>":()V\n   #2 = Fieldref           #19.#20        // java/lang/System.out:Ljava/io/PrintStream;\n   #3 = Methodref          #5.#21         // _01_factorial/Factorial.factorial:(I)I\n   #4 = Methodref          #22.#23        // java/io/PrintStream.println:(I)V\n   #5 = Class              #24            // _01_factorial/Factorial\n   #6 = Class              #25            // java/lang/Object\n   #7 = Utf8               <init>\n   #8 = Utf8               ()V\n   #9 = Utf8               Code\n  #10 = Utf8               LineNumberTable\n  #11 = Utf8               factorial\n  #12 = Utf8               (I)I\n  #13 = Utf8               StackMapTable\n  #14 = Utf8               main\n  #15 = Utf8               ([Ljava/lang/String;)V\n  #16 = Utf8               SourceFile\n  #17 = Utf8               Factorial.java\n  #18 = NameAndType        #7:#8          // "<init>":()V\n  #19 = Class              #26            // java/lang/System\n  #20 = NameAndType        #27:#28        // out:Ljava/io/PrintStream;\n  #21 = NameAndType        #11:#12        // factorial:(I)I\n  #22 = Class              #29            // java/io/PrintStream\n  #23 = NameAndType        #30:#31        // println:(I)V\n  #24 = Utf8               _01_factorial/Factorial\n  #25 = Utf8               java/lang/Object\n  #26 = Utf8               java/lang/System\n  #27 = Utf8               out\n  #28 = Utf8               Ljava/io/PrintStream;\n  #29 = Utf8               java/io/PrintStream\n  #30 = Utf8               println\n  #31 = Utf8               (I)V',e="0: iconst_1\n1: istore_1\n2: iconst_2\n3: istore_2\n4: iload_2\n5: iload_0\n6: if_icmpgt     19\n9: iload_1\n10: iload_2\n11: imul\n12: istore_1\n13: iinc          2, 1\n16: goto          4\n19: iload_1\n20: ireturn",i=" 0: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;\n3: iconst_5\n4: invokestatic  #3                  // Method plop:(I)I\n7: invokevirtual #4                  // Method java/io/PrintStream.println:(I)V\n10: return";exports.constantPool=t.constantPoolParser.parse(n),exports.sample=(new Map).set("plop:(I)I",a.methodParser.parse(exports.constantPool,2,3,1,e)).set("main",a.methodParser.parse(exports.constantPool,2,1,1,i));
},{"./impl/constant-parser":26,"./impl/instruction-parser":27}],23:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderConstantPool=function(n){return'\n<details>\n    <summary>Constant Pool</summary>\n    <div class="constants">\n      '+n.map(function(n){return'\n        <div class="index">'+n.index+'</div>\n        <div class="type">'+n.type+'</div>\n        <div class="value">'+n.value+"</div>\n        "}).join("\n")+"\n    </div>\n</details>\n"},exports.renderMethodCode=function(n,i){return'\n<ul class="code">\n  '+n.map(function(n){return'\n  <li class="'+function(n){return[n.instruction.type?"inst-"+n.instruction.type:"",i===n.position?"selected":""].filter(function(n){return""!==n}).join(" ")}(n)+'">\n    <div class="position">'+n.position+'</div>\n    <div class="code">'+n.instruction.code+'</div>\n    <div class="args">'+n.args+"</div>\n\n  </li>\n    "}).join("\n")+"\n</ul>\n"};
},{}],24:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e?'<div class="type-'+e.type+'" title="'+e.value+'">'+e.value+"</div>":'<div class="empty"></div>'};exports.renderLocals=function(n){return'\n<div class="locals">\n    <header>Locals</header>\n    <div>\n        '+n.list.map(e).join("\n")+"\n    </div>\n</div>\n"};
},{}],25:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e?'<div class="type-'+e.type+'" title="'+e.value+'">'+e.value+"</div>":'<div class="empty"></div>'};exports.renderStack=function(t){return'\n<div class="stack">\n    <header>Stack</header>\n    <div>\n        '+t.list.map(e).join("\n")+"\n    </div>\n</div>\n"};
},{}],13:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./inputs"),n=require("./locals"),r=require("./stack"),t=function(t){return'\n<article class="frame">\n  <header>'+t.name+" <span>"+t.args+"</span></header>\n  "+e.renderMethodCode(t.methodBody.code,t.position)+"\n  "+r.renderStack(t.stack)+"\n  "+n.renderLocals(t.locals)+"\n</article>\n"};exports.renderFrames=function(n){return"\n"+e.renderConstantPool(n.constantPool)+'\n<details open class="frames">\n    <summary>Frames</summary>\n    <menu>\n      <button type="button" class="next">↩️ Next</button>\n    </menu>\n    <div>\n      '+n.frames.map(function(e){return t(e)}).join("\n")+"\n    </div>\n</details>\n"};
},{"./inputs":23,"./locals":24,"./stack":25}],6:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./models/Frames"),n=require("./parser/sample"),r=require("./templates/frame"),t=new e.Frames(n.constantPool,n.sample);console.log({frames:t}),exports.catnip=function(e){null!==e?(e.innerHTML=r.renderFrames(t),document.querySelector(".frames menu .next").onclick=function(){t.next(),exports.catnip(e)}):console.warn("Cannot mount element:",e)},window.catnip=exports.catnip;
},{"./models/Frames":11,"./parser/sample":12,"./templates/frame":13}]},{},[6])
//# sourceMappingURL=/scripts.29be3b81.map